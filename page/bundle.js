(()=>{"use strict";(()=>{class e{constructor(e,t="key",i=1,s=""){this.element=document.createElement("div"),this.element.classList.add("btn"),this.element.classList.add(`btn--${t}`),"letters"===e&&this.element.classList.add("btn--magic"),this.element.id=e,this.element.innerHTML=s,i>1&&(this.element.style.flexGrow=i),this.code=e,this.key=s,this.label=s,this.type=t,this.isPressed=!1}changeLabel(e){this.element.innerHTML=e,this.label=e}}const t=[{lang:"Eng",shifted:!1,layout:{Backquote:"`",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Digit0:"0",Minus:"-",Equal:"=",KeyQ:"q",KeyW:"w",KeyE:"e",KeyR:"r",KeyT:"t",KeyY:"y",KeyU:"u",KeyI:"i",KeyO:"o",KeyP:"p",BracketLeft:"[",BracketRight:"]",Backslash:"\\",KeyA:"a",KeyS:"s",KeyD:"d",KeyF:"f",KeyG:"g",KeyH:"h",KeyJ:"j",KeyK:"k",KeyL:"l",Semicolon:";",Quote:"'",KeyZ:"z",KeyX:"x",KeyC:"c",KeyV:"v",KeyB:"b",KeyN:"n",KeyM:"m",Comma:",",Period:".",Slash:"/"}},{lang:"Eng",shifted:!0,layout:{Backquote:"~",Digit1:"!",Digit2:"@",Digit3:"#",Digit4:"$",Digit5:"%",Digit6:"^",Digit7:"&",Digit8:"*",Digit9:"(",Digit0:")",Minus:"_",Equal:"+",KeyQ:"Q",KeyW:"W",KeyE:"E",KeyR:"R",KeyT:"T",KeyY:"Y",KeyU:"U",KeyI:"I",KeyO:"O",KeyP:"P",BracketLeft:"{",BracketRight:"}",Backslash:"|",KeyA:"A",KeyS:"S",KeyD:"D",KeyF:"F",KeyG:"G",KeyH:"H",KeyJ:"J",KeyK:"K",KeyL:"L",Semicolon:":",Quote:'"',KeyZ:"Z",KeyX:"X",KeyC:"C",KeyV:"V",KeyB:"B",KeyN:"N",KeyM:"M",Comma:"<",Period:">",Slash:"?"}},{lang:"Rus",shifted:!1,layout:{Backquote:"ё",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Digit0:"0",Minus:"-",Equal:"=",KeyQ:"й",KeyW:"ц",KeyE:"у",KeyR:"к",KeyT:"е",KeyY:"н",KeyU:"г",KeyI:"ш",KeyO:"щ",KeyP:"з",BracketLeft:"х",BracketRight:"ъ",Backslash:"&#92;",KeyA:"ф",KeyS:"ы",KeyD:"в",KeyF:"а",KeyG:"п",KeyH:"р",KeyJ:"о",KeyK:"л",KeyL:"д",Semicolon:"ж",Quote:"э",KeyZ:"я",KeyX:"ч",KeyC:"с",KeyV:"м",KeyB:"и",KeyN:"т",KeyM:"ь",Comma:"б",Period:"ю",Slash:"."}},{lang:"Rus",shifted:!0,layout:{Backquote:"Ё",Digit1:"!",Digit2:'"',Digit3:"№",Digit4:";",Digit5:"%",Digit6:":",Digit7:"?",Digit8:"*",Digit9:"(",Digit0:")",Minus:"_",Equal:"+",KeyQ:"Й",KeyW:"Ц",KeyE:"У",KeyR:"К",KeyT:"Е",KeyY:"Н",KeyU:"Г",KeyI:"Ш",KeyO:"Щ",KeyP:"З",BracketLeft:"Х",BracketRight:"Ъ",Backslash:"/",KeyA:"Ф",KeyS:"Ы",KeyD:"В",KeyF:"А",KeyG:"П",KeyH:"Р",KeyJ:"О",KeyK:"Л",KeyL:"Д",Semicolon:"Ж",Quote:"Э",KeyZ:"Я",KeyX:"Ч",KeyC:"С",KeyV:"М",KeyB:"И",KeyN:"Т",KeyM:"Ь",Comma:"Б",Period:"Ю",Slash:","}},{lang:"Kids",shifted:!1,layout:{Backquote:"`",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Digit0:"0",Minus:"-",Equal:"=",KeyQ:"q",KeyW:"w",KeyE:"e",KeyR:"r",KeyT:"t",KeyY:"y",KeyU:"u",KeyI:"i",KeyO:"o",KeyP:"p",BracketLeft:"[",BracketRight:"]",Backslash:"\\",KeyA:"a",KeyS:"s",KeyD:"d",KeyF:"f",KeyG:"g",KeyH:"h",KeyJ:"j",KeyK:"k",KeyL:"l",Semicolon:";",Quote:"'",KeyZ:"z",KeyX:"x",KeyC:"c",KeyV:"v",KeyB:"b",KeyN:"n",KeyM:"m",Comma:",",Period:".",Slash:"/"}}],i="&#8679; Shift",s={line1:["Backquote:key","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace:Func:2:<big>⟵</big>&#8239;Backspace","Delete:Func:1:Del"],line2:["Tab:Func:1.5:Tab&#8239;<big>&#11120;</big>","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash:key:1.5","letters:letters::Aa"],line3:["CapsLock:Func:1.75:CapsLock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Enter:Func:2.25:Enter&#8239;<big>&#8629;</big>","poopies:poopies::9"],line4:[`ShiftLeft:Func:2.25:${i}`,"KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma:key","Period:key","Slash:key",`ShiftRight:Func:1.75:${i}`,"ArrowUp:Arrow:1:▲","kitty:kitty::A"],line5:["ControlLeft:Func:1.5:Ctrl",'MetaLeft:Func:1:<span class="material-symbols-outlined">\nkeyboard_command_key\n</span>',"AltLeft:Func:1:Alt","Space:Space:7.5:","AltRight:Func:1:Alt","ControlRight:Func:1:Ctrl","ArrowLeft:Arrow:1:◄","ArrowDown:Arrow:1:▼","ArrowRight:Arrow:1:►"]},a='  <div class="container">\n  <div class="components">\n    <div class="form">\n      <textarea autofocus type="text" class="form__input" placeholder="Type anything..."\n        tabindex="-1"></textarea>\n    </div>\n    <div class="info">Клавиатура создана в операционной системе Windows<br>\n      Для переключения языка комбинация: левыe shift + alt<br>\n      Иконочные шрифты только для английской раскладки</div>\n    <footer class="footer ">\n        <ul class="footer-list">\n          <li class="footer-item footer-text">© 2022</li>\n          <li>\n            <a class="footer-item link" href="https://github.com/LidaChk/virtual-keyboard">\n              <img class="footer-svg" src="./assets/svg/GitHub-Mark.svg" alt="GitHub Icon" width="30">\n            </a>\n          </li>\n          <li>\n            <a class="footer-item link" href="https://rs.school/js/">\n              <img class="footer-svg" src="./assets/svg/rs_school_js.svg" alt="Rsschool Icon" width="73">\n            </a>\n          </li>\n        </ul>\n  </div>\n</div>';(new class{constructor(){this.element=document.createElement("div"),this.element.classList.add("keyborad-container"),this.mode="letters",this.btns={},this.capsed=!1,this.shifted=!1,this.alted=!1,null===localStorage.getItem("rosely-vkb-lang")&&localStorage.setItem("rosely-vkb-lang","Eng"),this.lang=localStorage.getItem("rosely-vkb-lang"),this.langs="Eng"===this.lang?["Eng","Rus"]:["Rus","Eng"],this.mousePressedCode="",Object.keys(s).forEach((t=>{const i=document.createElement("div");i.classList.add("line-container"),i.classList.add(`keyboard-${t}`),s[t].forEach((t=>{const s=new e(...t.split(":"));i.appendChild(s.element),this.btns[s.code]=s})),this.element.appendChild(i)})),document.body.innerHTML=a,this.textarea=document.querySelector(".form__input"),document.querySelector(".form").after(this.element),this.addEvents()}addEvents(){this.element.addEventListener("mousedown",(e=>{const t=e.target.closest(".btn");t&&(this.mousePressedCode=t.id,this.activatekey(t.id))})),document.addEventListener("mouseup",(e=>{const t=e.target.closest(".btn");"Shift"!==this.mousePressedCode.slice(0,5)||t&&t.id===this.mousePressedCode?""!==this.mousePressedCode&&(this.deactivatekey(this.mousePressedCode),this.btns.ShiftLeft.isPressed&&this.deactivatekey(this.btns.ShiftLeft.code),this.btns.ShiftRight.isPressed&&this.deactivatekey(this.btns.ShiftRight.code),this.mousePressedCode=""):this.shifted=!0})),document.addEventListener("keydown",(e=>{this.activatekey(e.code)&&e.preventDefault()})),document.addEventListener("keyup",(e=>{this.deactivatekey(e.code)&&e.preventDefault()}))}switchLang(){this.lang=this.langs.pop(),this.langs.unshift(this.lang),localStorage.setItem("rosely-vkb-lang",this.lang)}activatekey(e){const t=this.btns[e],i=this.textarea.selectionStart,s=this.textarea.selectionEnd,{value:a}=this.textarea;return!!t&&(t.element.classList.add("btn--active"),"CapsLock"!==e||t.isPressed?"Shift"!==e.slice(0,5)||t.isPressed?"Alt"!==e.slice(0,3)||t.isPressed?"Enter"===e?this.textarea.value+="\n":"Tab"===e?this.textarea.value+="\t":"Backspace"===e||"Delete"===e?s>i?(this.textarea.value=`${a.slice(0,i)}${a.slice(s)}`,this.textarea.selectionEnd=i):"Backspace"===e?(this.textarea.value=`${a.slice(0,i-1)}${a.slice(s)}`,this.textarea.selectionEnd=i-1):"Delete"===e&&(this.textarea.value=`${a.slice(0,i)}${a.slice(s+1)}`,this.textarea.selectionEnd=i):"Space"===t.type?(this.textarea.value=`${a.slice(0,i)} ${a.slice(s)}`,this.textarea.selectionEnd=i+1):"key"===t.type||"Arrow"===t.type?(this.textarea.value=`${a.slice(0,i)}${t.label}${a.slice(s)}`,this.textarea.selectionEnd=i+1):"kitty"!==t.type&&"poopies"!==t.type&&"letters"!==t.type||t.type!==this.mode&&this.toggleMode(t.type):(this.alted=!this.alted,t.isPressed=!0,this.shifted&&(this.switchLang(),this.initLang())):(this.shifted=!this.shifted,t.isPressed=!0,this.alted&&this.switchLang(),this.initLang()):(this.capsed=!this.capsed,t.element.classList.toggle("capsed"),t.isPressed=!0,this.initLang()),!0)}deactivatekey(e){const t=this.btns[e];return!!t&&(t&&t.element.classList.remove("btn--active"),"CapsLock"===e?t.isPressed=!1:"Shift"===e.slice(0,5)&&t.isPressed?(this.shifted=!this.shifted,t.isPressed=!1,this.initLang()):"Alt"===e.slice(0,3)&&t.isPressed&&(this.alted=!this.alted,t.isPressed=!1),!0)}initLang(){const e=t.find((e=>e.lang===this.lang&&e.shifted===this.shifted)).layout;Object.keys(this.btns).filter((e=>"key"===this.btns[e].type)).forEach((t=>{this.capsed&&this.shifted&&"Key"===t.slice(0,3)?this.btns[t].changeLabel(e[t].toLowerCase()):this.capsed&&!this.shifted&&"Key"===t.slice(0,3)?this.btns[t].changeLabel(e[t].toUpperCase()):this.btns[t].changeLabel(e[t])}))}toggleMode(e){this.textarea.classList.remove("poopies"),this.textarea.classList.remove("kitty"),"letters"!==e&&this.textarea.classList.add(e),Object.keys(this.btns).filter((e=>"key"===this.btns[e].type)).forEach((t=>{this.btns[t].element.classList.remove("poopies"),this.btns[t].element.classList.remove("kitty"),"letters"!==e&&this.btns[t].element.classList.add(e)})),this.btns.letters.element.classList.remove("btn--magic"),this.btns.kitty.element.classList.remove("btn--magic"),this.btns.poopies.element.classList.remove("btn--magic"),this.btns[e].element.classList.add("btn--magic"),this.mode=e}}).initLang()})()})();